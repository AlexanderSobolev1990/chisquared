      !#########################################################################
      !>
      !> TEST CHI SQUARED
      !>
      PROGRAM TEST_CHI_SQUARED
      REAL X_COORD!,Y_COORD
      REAL::DEGREE=3.0 ! DEGREE OF FREEDOM
      REAL::FSTEP=0.01 ! STEP OF PLOT ON X AXIS
      REAL::FMIN=0.0 ! MAX VALUE ON X AXIS
      REAL::FMAX=4.0 ! MAX VALUE ON X AXIS
      INTEGER::ISTEPS!=INT(ABS(FMAX-FMIN)/FSTEP)+1 ! COUNT OF POINTS
      ISTEPS=INT(ABS(FMAX-FMIN)/FSTEP)+1 ! COUNT OF POINTS
      
      !#########################################################################
      OPEN(100,FILE='TEST_CANAL.DAT',STATUS='UNKNOWN')
      OPEN(200,FILE='TEST_KELLEY.DAT',STATUS='UNKNOWN')
      OPEN(300,FILE='TEST_PEIZERPRATT.DAT',STATUS='UNKNOWN')
      OPEN(400,FILE='TEST_SOBOLEV.DAT',STATUS='UNKNOWN')

      OPEN(500,FILE='TEST_SOBOLEV_CANAL.DAT',STATUS='UNKNOWN')
      OPEN(600,FILE='TEST_SOBOLEV_KELLEY.DAT',STATUS='UNKNOWN')
      OPEN(700,FILE='TEST_SOBOLEV_PEIZERPRATT.DAT',STATUS='UNKNOWN')

      DO J=1,ISTEPS
        X_COORD=FMIN+(J-1)*FSTEP
        Y_CANAL=CHI_SQ_CANAL(X_COORD,DEGREE)
        Y_KELLEY=CHI_SQ_KELLEY(X_COORD,DEGREE)
        Y_PEIZERPRATT=CHI_SQ_PEIZERPRATT(X_COORD,DEGREE)
        Y_POLY=CHI_SQ_POLY_3_DEG(X_COORD)

        Y_POLY_CANAL=Y_POLY-Y_CANAL
        Y_POLY_KELLEY=Y_POLY-Y_KELLEY
        Y_POLY_PEIZERPRATT=Y_POLY-Y_PEIZERPRATT

        WRITE(100,'(F12.6,1X,F12.6)') X_COORD, Y_CANAL
        WRITE(200,'(F12.6,1X,F12.6)') X_COORD, Y_KELLEY
        WRITE(300,'(F12.6,1X,F12.6)') X_COORD, Y_PEIZERPRATT
        WRITE(400,'(F12.6,1X,F12.6)') X_COORD, Y_POLY

        WRITE(500,'(F12.6,1X,F12.6)') X_COORD, Y_POLY_CANAL
        WRITE(600,'(F12.6,1X,F12.6)') X_COORD, Y_POLY_KELLEY
        WRITE(700,'(F12.6,1X,F12.6)') X_COORD, Y_POLY_PEIZERPRATT

      ENDDO

      CLOSE(100)
      CLOSE(200)
      CLOSE(300)
      CLOSE(400)
      CLOSE(500)
      CLOSE(600)
      CLOSE(700)

C      DO I=1,4
C        SELECT CASE(I)
C          CASE(1) ! CANAL
C            OPEN(100,FILE='TEST_CANAL.DAT',STATUS='UNKNOWN')
C            DO J=1,ISTEPS
C              X_COORD=FMIN+(J-1)*FSTEP
C              Y_COORD=CHI_SQ_CANAL(X_COORD,DEGREE)
C              WRITE(100,'(F12.6,1X,F12.6)') X_COORD, Y_COORD
C            ENDDO
C            CLOSE(100)
C          CASE(2) ! KELLEY
C            OPEN(100,FILE='TEST_KELLEY.DAT',STATUS='UNKNOWN')
C            DO J=1,ISTEPS
C              X_COORD=FMIN+(J-1)*FSTEP
C              Y_COORD=CHI_SQ_KELLEY(X_COORD,DEGREE)
C              WRITE(100,'(F12.6,1X,F12.6)') X_COORD, Y_COORD
C            ENDDO
C            CLOSE(100)
C          CASE(3) ! PEIZERPRATT
C            OPEN(100,FILE='TEST_PEIZERPRATT.DAT',STATUS='UNKNOWN')
C            DO J=1,ISTEPS
C              X_COORD=FMIN+(J-1)*FSTEP
C              Y_COORD=CHI_SQ_PEIZERPRATT(X_COORD,DEGREE)
C              WRITE(100,'(F12.6,1X,F12.6)') X_COORD, Y_COORD
C            ENDDO
C            CLOSE(100)
C          CASE(4) ! SOBOLEV
C            OPEN(100,FILE='TEST_SOBOLEV.DAT',STATUS='UNKNOWN')
C            DO J=1,ISTEPS
C              X_COORD=FMIN+(J-1)*FSTEP
C              Y_COORD=CHI_SQ_POLY_3_DEG(X_COORD)
C              WRITE(100,'(F12.6,1X,F12.6)') X_COORD, Y_COORD
C            ENDDO
C            CLOSE(100)
C        END SELECT
C      ENDDO
      PRINT *,'PROGRAMM FINISHED, PRESS ANY KEY TO EXIT...'
      READ *
      END
